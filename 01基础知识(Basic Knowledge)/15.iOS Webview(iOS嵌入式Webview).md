# iOS WebViews

本篇指导你如何将Cordova的WebView模块嵌入到一个iOS应用当中，以及相互之间如何进行通信请参照plugins。

首先你需要通过Cordova CLI创建一个空工程，然后用Xcode打开根目录/platform/ios目录下的Xcode工程。参考这个工程结构。我们的目的就是将CordovaLib添加到已有的iOS项目中去。

## 添加Cleaver到你的Xcode工程(CordovaLib Sub-Project)

1. 退出Xcode。

2. 打开一个命令行并进入一个cordova工程的iOS目录。

3. 拷贝`config.xml`文件到iOS项目目录。

4. 打开Xcode，将`config.xml`文件添加到Xcode工程的Navigate中去。

5. 选择Create groups然后点__Finish__。

6. 拷贝/platform/ios目录下的`CordovaLib`到iOS工程目录，并导入。

7. Select `CordovaLib.xcodeproj` within the __Project Navigator__.

8. Type the __Option-Command-1__ key combination to show the __File
   Inspector__.

9. Choose __Relative to Group__ in the __File Inspector__ for the
   drop-down menu for __Location__.

10. Select the __project icon__ in the __Project Navigator__, select
   the __Target__, then select the __Build Settings__ tab.

11. Add `-force_load` and `-Obj-C` for the __Other Linker Flags__ value.

12. Click on the __project icon__ in the Project Navigator, select the
   __Target__, then select the __Build Phases__ tab.

13. Expand __Link Binaries with Libraries__.

14. Select the __+__ button, and add the following __frameworks__.
   Optionally within the __Project Navigator__, move them under the
   __Frameworks__ group:

    ```
    AssetsLibrary.framework
    CoreLocation.framework
    CoreGraphics.framework
    MobileCoreServices.framework
    ```

15. Expand __Target Dependencies__, the top box with that label if
   there's more than one box.

16. Select the __+__ button, and add the `CordovaLib` build product.

17. Expand __Link Binaries with Libraries__, the top box with that label
  if there's more than one box.

18. Select the __+__ button, and add `libCordova.a`.

19. Set the __Xcode Preferences &rarr; Locations &rarr; Derived Data
   &rarr; Advanced...__ to __Unique__.

20. Select the __project icon__ in the Project Navigator, select your
   __Target__, then select the __Build Settings__ tab.

21. Search for __Header Search Paths__. For that setting, add these
   three values below, including the quotes:

    ```
    "$(TARGET_BUILD_DIR)/usr/local/lib/include"
    "$(OBJROOT)/UninstalledProducts/include"
    "$(OBJROOT)/UninstalledProducts/$(PLATFORM_NAME)/include"
    "$(BUILT_PRODUCTS_DIR)"
    ```

    As of Cordova 2.1.0, `CordovaLib` has been upgraded to use
    __Automatic Reference Counting (ARC)__. You don't need to upgrade
    to __ARC__ to use `CordovaLib`, but if you want to upgrade your
    project to use __ARC__, you should use the Xcode migration wizard
    from the __Edit &rarr; Refactor &rarr; Convert to Objective-C
    ARC...__ menu, __de-select libCordova.a__, then run the wizard to
    completion.

## 使用CDVViewController

1. 引入如下头文件:

```objective_c
    #import <Cordova/CDVViewController.h>
```

2. 实例化一个`CDVViewController`对象，并作为一个class属性:

```objective_c
    CDVViewController* viewController = [CDVViewController new];
```

3. 可选步骤，设置`wwwFolderName`属性,默认为`www`:

```objective_c
    viewController.wwwFolderName = @"myfolder";
```

4. 可选步骤，设置`config.xml`文件的`<content>标签指定一个本地文件:

```xml
    <content src="index.html" />
```

    ...or a remote site:

```xml
    <content src="http://apache.org" />
```

5. 可选步骤，设置`useSplashScreen`:

```objective_c
    viewController.useSplashScreen = YES;
```

6. 设置view，总是要最后再设置这个属性:

```objective_c
    viewController.view.frame = CGRectMake(0, 0, 320, 480);
```

7. 添加Cleaver:

```objective_c
    [myView addSubview:viewController.view];
```

## 添加HTML, CSS and JavaScript资源

1. 生成一个新的目录`www`。

2. 把HTML, CSS and JavaScript放入该目录。

3. 将www目录导入到Xcode的ios工程中。

4. 在`CDVViewController`中设置`wwwFolderName`和`startPage`或者使用默认设置

```objective_c
    /*
        if you created a folder called 'myfolder' and
        you want the file 'mypage.html' in it to be
        the startPage
    */
    viewController.wwwFolderName = @"myfolder";
    viewController.startPage = @"mypage.html"
```

